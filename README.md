# Spider-Go ğŸ•·ï¸

ä¸€ä¸ªåŸºäº Golang çš„æ•™åŠ¡ç³»ç»Ÿæ•°æ®çˆ¬è™«å’Œç®¡ç†å¹³å°ï¼Œæä¾›æˆç»©æŸ¥è¯¢ã€è¯¾ç¨‹è¡¨æŸ¥è¯¢ã€è€ƒè¯•å®‰æ’æŸ¥è¯¢ç­‰åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ“š ç”¨æˆ·åŠŸèƒ½
- ç”¨æˆ·æ³¨å†Œ/ç™»å½•ï¼ˆJWT è®¤è¯ï¼‰
- ç»‘å®šæ•™åŠ¡ç³»ç»Ÿè´¦å·
- æŸ¥è¯¢å…¨éƒ¨æˆç»©/æŒ‰å­¦æœŸæŸ¥è¯¢æˆç»©
- æŸ¥è¯¢ç­‰çº§è€ƒè¯•æˆç»©ï¼ˆå››å…­çº§ç­‰ï¼‰
- æŸ¥è¯¢è¯¾ç¨‹è¡¨ï¼ˆæŒ‰å‘¨ï¼‰
- æŸ¥è¯¢è€ƒè¯•å®‰æ’
- ğŸ“Š **æˆç»©åˆ†æ**ï¼šæœ€è¿‘ä¸‰ä¸ªå­¦æœŸçš„æˆç»©è¶‹åŠ¿åˆ†æ
- æŸ¥çœ‹ç³»ç»Ÿé€šçŸ¥

### ğŸ‘‘ ç®¡ç†å‘˜åŠŸèƒ½
- ç®¡ç†å‘˜ç™»å½•ï¼ˆç‹¬ç«‹è®¤è¯ï¼‰
- ğŸ“ é€šçŸ¥ç®¡ç†ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰
- ğŸ“ˆ æ—¥æ´»ç»Ÿè®¡ï¼ˆDAUï¼‰
- ğŸ—“ï¸ å­¦æœŸé…ç½®ç®¡ç†
- ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 

### ğŸ” å®‰å…¨åŠŸèƒ½
- é‚®ç®±éªŒè¯ç å‘é€
- å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆbcryptï¼‰
- JWT ä»¤ç‰Œè®¤è¯
- æ•™åŠ¡ç³»ç»Ÿä¼šè¯ç¼“å­˜ï¼ˆ1å°æ—¶ï¼‰

### ğŸ“Š ç»Ÿè®¡åŠŸèƒ½
- æ—¥æ´»ç»Ÿè®¡ï¼ˆDAUï¼‰
- è‡ªåŠ¨è®°å½•ç”¨æˆ·æ´»è·ƒ
- æ•°æ®ä¿ç•™ 30 å¤©
- æ”¯æŒæ—¥æœŸèŒƒå›´æŸ¥è¯¢

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### åˆ†å±‚è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           API Layer (Gin)               â”‚  è·¯ç”±å±‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Controller Layer                â”‚  æ§åˆ¶å™¨å±‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Service Layer                  â”‚  ä¸šåŠ¡é€»è¾‘å±‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Repository  â”‚   Cache   â”‚   Crawler    â”‚  æ•°æ®è®¿é—®å±‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    MySQL    â”‚   Redis   â”‚   HTTP        â”‚  åŸºç¡€è®¾æ–½å±‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„

```
spider-go/
â”œâ”€â”€ config/                  # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ config.yaml
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ api/                 # è·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ app/                 # åº”ç”¨åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ config.go        # é…ç½®åŠ è½½
â”‚   â”‚   â”œâ”€â”€ db.go            # æ•°æ®åº“åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ redis_client.go  # Redis åˆå§‹åŒ–
â”‚   â”‚   â””â”€â”€ container.go     # ä¾èµ–æ³¨å…¥å®¹å™¨
â”‚   â”œâ”€â”€ cache/               # ç¼“å­˜å±‚
â”‚   â”‚   â”œâ”€â”€ session_cache.go # ä¼šè¯ç¼“å­˜
â”‚   â”‚   â”œâ”€â”€ captcha_cache.go # éªŒè¯ç ç¼“å­˜
â”‚   â”‚   â”œâ”€â”€ dau_cache.go     # æ—¥æ´»ç»Ÿè®¡ç¼“å­˜
â”‚   â”‚   â””â”€â”€ config_cache.go  # ç³»ç»Ÿé…ç½®ç¼“å­˜
â”‚   â”œâ”€â”€ common/              # å…¬å…±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ errors.go        # é”™è¯¯ç å®šä¹‰
â”‚   â”‚   â””â”€â”€ response.go      # ç»Ÿä¸€å“åº”
â”‚   â”œâ”€â”€ controller/          # æ§åˆ¶å™¨å±‚
â”‚   â”œâ”€â”€ dto/                 # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ middleware/          # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ jwtauth.go       # JWT è®¤è¯
â”‚   â”‚   â””â”€â”€ admin_auth.go    # ç®¡ç†å‘˜è®¤è¯
â”‚   â”œâ”€â”€ model/               # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ repository/          # æ•°æ®ä»“å‚¨
â”‚   â”œâ”€â”€ service/             # ä¸šåŠ¡æœåŠ¡
â”‚   â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
â””â”€â”€ main.go                  # å…¥å£æ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Go 1.25+
- MySQL 5.7+
- Redis 5.0+

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <your-repo-url>
cd spider-go
```

2. **å®‰è£…ä¾èµ–**
```bash
go mod download
```

3. **é…ç½®æ–‡ä»¶**

ç¼–è¾‘ `config/config.yaml`ï¼š

```yaml
app:
  port: 8080

database:
  source: 127.0.0.1
  port: 3306
  user: your_db_user
  pass: your_db_password
  name: spider_go

redis:
  session:
    host: 127.0.0.1:6379
    pass: your_redis_password
    db: 0
  captcha:
    host: 127.0.0.1:6379
    pass: your_redis_password
    db: 1

jwt:
  secret: "your-super-secret-jwt-key"
  issuer: "spider-go"

jwc:
  login_url: "https://authserver.csuft.edu.cn/authserver/login?service=http%3A%2F%2Fjwgl.csuft.edu.cn%2F"
  course_url: "http://jwgl.csuft.edu.cn/jsxsd/xskb/xskb_list.do"
  grade_url: "http://jwgl.csuft.edu.cn/jsxsd/kscj/cjcx_list"
  grade_level_url: "http://jwgl.csuft.edu.cn/jsxsd/kscj/djkscj_list"
  exam_url: "https://http-jwgl-csuft-edu-cn-80.webvpn.csuft.edu.cn/jsxsd/xsks/xsksap_list"

email:
  smtp_host: "smtp.qq.com"
  smtp_port: 465
  username: "your-email@qq.com"
  password: "your-smtp-auth-code"
  from_name: "Spider-Go éªŒè¯ç "
```

4. **è¿è¡Œé¡¹ç›®**
```bash
go run main.go
# æˆ–ç¼–è¯‘åè¿è¡Œ
go build -o spider-go.exe
./spider-go.exe
```

5. **è®¿é—®æœåŠ¡**
```
æœåŠ¡åœ°å€: http://localhost:8080
```

## ğŸ”‘ é»˜è®¤è´¦å·

### ç®¡ç†å‘˜è´¦å·ï¼ˆé¦–æ¬¡å¯åŠ¨è‡ªåŠ¨åˆ›å»ºï¼‰
- **é‚®ç®±**: `admin@spider-go.com`
- **å¯†ç **: `123456`
- **æƒé™**: å…¨éƒ¨ç®¡ç†æƒé™

âš ï¸ **é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼**

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½è¯´æ˜

### 1. ä¾èµ–æ³¨å…¥å®¹å™¨

é¡¹ç›®ä½¿ç”¨ä¾èµ–æ³¨å…¥å®¹å™¨ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ä¾èµ–ï¼Œé¿å…å…¨å±€å˜é‡ï¼š

```go
container, err := app.NewContainer("./config")
// è‡ªåŠ¨åˆå§‹åŒ–ï¼š
// - é…ç½®åŠ è½½
// - æ•°æ®åº“è¿æ¥
// - Redis è¿æ¥
// - æ‰€æœ‰ Service å’Œ Controller
// - é»˜è®¤ç®¡ç†å‘˜
```

### 2. ç¼“å­˜ç­–ç•¥

#### Redis DB 0ï¼ˆä¼šè¯ + æ—¥æ´» + é…ç½®ï¼‰
- ç”¨æˆ·ç™»å½•ä¼šè¯ï¼ˆ1å°æ—¶è¿‡æœŸï¼‰
- æ—¥æ´»ç»Ÿè®¡æ•°æ®ï¼ˆ30å¤©è¿‡æœŸï¼‰
- ç³»ç»Ÿé…ç½®ï¼ˆæ°¸ä¹…ï¼‰

#### Redis DB 1ï¼ˆéªŒè¯ç ï¼‰
- é‚®ç®±éªŒè¯ç ï¼ˆ5åˆ†é’Ÿè¿‡æœŸï¼‰

### 3. æ—¥æ´»ç»Ÿè®¡

- âœ… ç”¨æˆ·ç™»å½•è‡ªåŠ¨è®°å½•
- âœ… ä½¿ç”¨ JWT è®¿é—®ä»»æ„æ¥å£è‡ªåŠ¨è®°å½•
- âœ… åŒä¸€ç”¨æˆ·ä¸€å¤©åªè®¡æ•°ä¸€æ¬¡ï¼ˆRedis Set è‡ªåŠ¨å»é‡ï¼‰
- âœ… æœ¬åœ°ç¼“å­˜ä¼˜åŒ–ï¼Œå‡å°‘ Redis å‹åŠ›
- âœ… æ•°æ®ä¿ç•™ 30 å¤©

### 4. æˆç»©åˆ†æ

- ğŸ“Š æ˜¾ç¤ºæœ€è¿‘ä¸‰ä¸ªå­¦æœŸçš„æˆç»©
- ğŸ“ˆ GPA è¶‹åŠ¿åˆ†æï¼ˆä¸Šå‡/ä¸‹é™/ç¨³å®šï¼‰
- ğŸ† æœ€å¥½/æœ€å·®å­¦æœŸç»Ÿè®¡
- ğŸ“‰ å„å­¦æœŸå¯¹æ¯”

## ğŸ“– API æ–‡æ¡£

è¯¦è§ [API_DOCUMENTATION.md](./API_DOCUMENTATION.md)

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **Web æ¡†æ¶**: Gin
- **æ•°æ®åº“ ORM**: GORM
- **ç¼“å­˜**: Redis (go-redis/v9)
- **JWT**: golang-jwt/jwt
- **HTML è§£æ**: goquery
- **é‚®ä»¶å‘é€**: gomail.v2
- **é…ç½®ç®¡ç†**: Viper
- **å¯†ç åŠ å¯†**: bcrypt

## ğŸ“ æ•°æ®åº“è¡¨

### usersï¼ˆç”¨æˆ·è¡¨ï¼‰
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| uid | int | ç”¨æˆ·IDï¼ˆä¸»é”®ï¼‰ |
| email | string | é‚®ç®±ï¼ˆå”¯ä¸€ï¼‰ |
| name | string | ç”¨æˆ·å |
| password | string | å¯†ç ï¼ˆåŠ å¯†ï¼‰ |
| sid | string | æ•™åŠ¡ç³»ç»Ÿå­¦å· |
| spwd | string | æ•™åŠ¡ç³»ç»Ÿå¯†ç  |
| created_at | datetime | åˆ›å»ºæ—¶é—´ |
| avatar | string | å¤´åƒé“¾æ¥ |

### administratorsï¼ˆç®¡ç†å‘˜è¡¨ï¼‰
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| uid | int | ç®¡ç†å‘˜IDï¼ˆä¸»é”®ï¼‰ |
| email | string | é‚®ç®±ï¼ˆå”¯ä¸€ï¼‰ |
| name | string | ç®¡ç†å‘˜å |
| password | string | å¯†ç ï¼ˆåŠ å¯†ï¼‰ |
| created_at | datetime | åˆ›å»ºæ—¶é—´ |
| avatar | string | å¤´åƒé“¾æ¥ |

### noticesï¼ˆé€šçŸ¥è¡¨ï¼‰
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| nid | int | é€šçŸ¥IDï¼ˆä¸»é”®ï¼‰ |
| content | text | é€šçŸ¥å†…å®¹ |
| notice_type | string | é€šçŸ¥ç±»å‹ |
| is_show | bool | æ˜¯å¦æ˜¾ç¤º |
| create_time | datetime | åˆ›å»ºæ—¶é—´ |
| update_time | datetime | æ›´æ–°æ—¶é—´ |
| is_top | bool | æ˜¯å¦ç½®é¡¶ |
| is_html | bool | æ˜¯å¦HTMLæ ¼å¼ |

## ğŸ”§ å¼€å‘å»ºè®®

### ç¯å¢ƒå˜é‡ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

ç”Ÿäº§ç¯å¢ƒå»ºè®®é€šè¿‡ç¯å¢ƒå˜é‡è¦†ç›–æ•æ„Ÿé…ç½®ï¼š

```bash
export SPIDER_JWT_SECRET="your-production-secret"
export SPIDER_DB_PASSWORD="your-db-password"
export SPIDER_REDIS_PASSWORD="your-redis-password"
```

### æ—¥å¿—

å»ºè®®æ·»åŠ ç»“æ„åŒ–æ—¥å¿—ï¼ˆå¦‚ zap æˆ– logrusï¼‰

### ç›‘æ§

å»ºè®®æ·»åŠ ï¼š
- Prometheus æŒ‡æ ‡
- é“¾è·¯è¿½è¸ªï¼ˆJaegerï¼‰
- æ€§èƒ½ç›‘æ§

## ğŸ“ å¾…åŠäº‹é¡¹

- [ ] æ·»åŠ å•å…ƒæµ‹è¯•
- [ ] æ·»åŠ é›†æˆæµ‹è¯•
- [ ] æ·»åŠ  API é™æµ
- [ ] æ·»åŠ æ•°æ®åº“è¿æ¥æ± é…ç½®
- [ ] æ·»åŠ ä¼˜é›…å…³é—­æœºåˆ¶
- [ ] æ·»åŠ å¥åº·æ£€æŸ¥æ¥å£

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ‘¥ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ Issue è”ç³»ã€‚

